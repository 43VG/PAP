{% extends "homepage.html" %}
{% block content %}
<div class="container">
    <h1>Bem-vindo ao Dashboard, {{ current_user.nome }}!</h1>

    <!-- Upload de ficheiros Excel -->
    <form action="{{ url_for('rotas.upload_excel') }}" method="post" enctype="multipart/form-data">
        <label for="ficheiros">Seleciona ficheiros Excel:</label><br>
        <input type="file" name="ficheiros" multiple required><br><br>
        <button type="submit">Carregar ficheiros</button>
    </form>

    {% if folhas_por_ficheiro %}
        <hr>
        <form action="{{ url_for('rotas.selecionar_folhas') }}" method="post">
            <h3>Seleciona as folhas que queres usar:</h3>
            {% for nome, folhas in folhas_por_ficheiro.items() %}
                <strong>{{ nome }}</strong><br>
                {% for folha in folhas %}
                    <input type="checkbox" name="selecionadas_{{ nome }}" value="{{ folha }}" checked>
                    {{ folha }}<br>
                {% endfor %}
                <br>
            {% endfor %}
            <!-- Guardar nomes dos ficheiros no form -->
            {% for nome in folhas_por_ficheiro %}
                <input type="hidden" name="ficheiros_nome" value="{{ nome }}">
            {% endfor %}
            <button type="submit">Confirmar folhas</button>
        </form>
    {% endif %}
</div>
{% endblock %}
